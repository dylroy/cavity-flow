**ACTIVE WORK-IN-PROGRESS**
# Building a framework for exploratory Geophysical Fluid Dynamics: A test-case with Lid-Driven Cavity Flows
### created by: Dylan Joseph Roy-Leo

# Introduction
#### Interest in GFD

Salt marshes are incredibly important ecosystems for many coastal communities around the world. Among the many services that they provide, the one of relevance to me is their ability to buffer shorelines against relative sea level rise (RSLR) and prevent the erosion of coastal sedimentary cliffs. However, salt marshes require a yearly sediment budget, potentially transported through the marshes connection with the sea as sediment is carried in with the tide, or potentially transported via rivers that connect to the marsh and periodically dump massive amounts of sediment directly onto the marsh platform after large storm events. As for the first avenue of sediment transport, the open ocean, there are limited sources to where that sediment can come from. Either, the sediment came originally from a river and travelled to the open ocean where coastal currents carried it back into a marsh, the sediment was resuspended from the ocean shelf by a large storm, or the sediment was directly eroded from the land (most likely by a large storm event) and transported to the marsh via coastal currents. The easiest of those three possibilities to probe, and the topic of my Master's thesis, is the last. I'm interested in how sediment eroded from coastal landforms called bluffs is transported from the site of erosion by coastal currents, and my big question is "how much of the sediment eroded from bluffs gets deposited on the marsh surface?".

The first part of my Master's thesis was focused on quantifying the volume and mass of fine-grain sediment eroded from the coast via combining LiDAR differencing with Surficial Geology data. The results from that work proved to be interesting, but not satisfying. I was able to show that bluff erosion supplied more than enough sediment between 2011 and 2021 in Massachusetts to the coastal zone than what all marshes in Massachusetts would require within that same time frame. This is not what we expected, and shows that bluff erosion may be a significant contributor in marsh sustenance.

However, there is a problem. For none of the eroded sediment that I was able to document, *none of it*, was I able to say made it way to a marsh platform. Let alone deposited and contributed to its accretion. Once sediment is eroded from the coast, its a black box, with the methods I had at my diposal I was not able to say that even a single kilogram made its way to a marsh. And in fact, in some areas where eroded bluff were further downstream in a littoral cell from a marsh, you could pretty confidently say that the sediment from particular bluff would *never* make it to a particular marsh. To me, this highlighted the pressing need to find a method that would allow you to make predictions about the incredibly complex nature of coastal currents, and the sediment suspended therein.

With that said salt marshes are inherently dynamical systems. Their very nature is tied, at the very least, to the daily cycle of tides which pushes massives amounts of fluid onto the marsh surface. This water interacts in complex and mostly unknown ways with topology of the marsh and with the vegetation on the marsh. The mechanics of how coastal waters flow over the marsh surface, and how that flow impacts marsh characteristics such as sediment delivery, is an incredibly complex topic. Three-dimensional fluid mechanic models such as the Finite Volume Community Ocean Model (FVCOM) are as close as we have to understanding the meso-scale dynamics of marsh ecosystems. These models have given us valuable insights into how salinity, temperature, and suspended sediment are transported in a marsh.

Enter Geophysical Fluid Dynamics. One of the more fascinating and tempting subjects I've encountered in a long time, GFD is the study and pursuit of modelling the fluid dynamics of planet earth. This can include atmospheric GFD where weather patterns and atmospheric circulations are studied, and it can also include physical oceanography were ocean currents at both large and small scale are studied. There are other brands of fluid dynamics as well, including Computational Fluid Dynamics, and in many ways they all feed into one another. GFD is particularly interesting to me not just becuase it might allow me an avenue to answer my Thesis questions, but also becuase I've come to recognize the particular strength that GFD holds within the realm of fluid dynamics. And that strength is its vast complexity. Geophysical systems are noisy, irregular, and can have upwards of infinite degrees of freedom, and these facts can make it incredibly difficult to model geophysical systems. However, in the same token, GFD is incredibly rich and has a vast wealth of untapped potential. In combination with advances in both the field of data driven science and engineering as well as remote sensing, I believe GFD has more to offer than ever, highlighting my fervent interest in diving head-first into this subject.

#### Motivations for this project
As I've spent around the past year or so diving into GFD, one thing that always irked me was my inability to model the systems I was learning about. I assumed that as I became more familiar with the theoretical foundation of solving the PDEs required to model fluid flow, and as I became more competent in the algorithmic methods used to translate continuous mathematics to discrete machines, that I would slowly be able to model more and more systems, finally giving me the hands-on experience I was craving from this field. This . . . sort of, came to pass. Watching YouTube tutorials online its pretty easy to boot up Python or Matlab and follow the guide step-by-step to get a working model of some rudimentary system. However, as I came to find, this had limited applicability when it came to hands-on learning. The reason for that is that when I built these models, I wanted to mess with everything, all the parameters, all the modules, all the configurations. But fluid dynamics models are usually built exactly for the problem at hand, and there is so much intricacy in the boundary conditions, the initial conditions, the choice of numerical solver, how the numerical solver and the boundary conditions interact, and the time stepping scheme, among many, many others.

My goal for this project initially was to develop a framework for building toy dynamical systems models. The result, I was hoping, was for a fairly straighforward and educational way to piece together different aspects of fluid dynamics simulations like Lego bricks. Besides simple things like changing the time step, I wanted to know what would be the result of changing the integrator from a Runge-Kutta fourth order scheme to a Runge-Kutta second order scheme? If I solve the PDE in Fourier coordinates and inverse transform back (spectral methods), how does that compare to locally calculating derivatives and solving that way (finite-difference)?

I went at this project that this would be the start to a life-long personal project, which perhaps was the wrong way to go about it, as scope-creep and perfectionism became a real hurdle to jump over. In the end though, what I decided was that for this project in particular, this was to be a test-case for my vision. I decided to use the Lid-Driven Cavity Flow simulation as the prototype for what a GFD simulation framework might look like in the future, I'll describe my reasons for this simulation in particular below.

#### Lid-Driven Cavity Flow
As stated above, GFD simulations can be very difficult to set up, especially without the priviledge of a background in engineering or applied mathematics. The Lid-Driven Cavity Flow was chosen as a test-case for this project for the reason that its fairly simple, it can be implemented on a uniform and structured mesh (reducing complexity), it models fluid dynamics using the Navier-Stokes equations (benchmark of fluid dynamics), it can display complex and interesting behavior, and it's directly applicable to some of the dynamics observed in natural systems (natural cavities like back-barrier marshes).

The concept behind the Lid-Driven Cavity Flow is fairly straightforward, there is a box filled with fluid with one side of the box open (typically the top, hence the name *Lid*-Driven). Along that open side, we imagine that there is a constant stream of fluid interacting with that side (outside of the domain), causing the fluid along that side to be consistently pushed in one direction (typically to the right). After we set up the domain, we *prescribe* a constant velocity to the cells along the top of the box, and the rest of the simulation is calculating the resulting dynamics of the rest of the fluid within the box.

# Governing Equations and Numerical Methods
As mentioned in the introduction, the Lid-Driven Cavity Flow model is "powered" by the Navier-Stokes system of equations. Let's break them down below:

First equation (momentum equation): $\frac{\partial U}{\partial t} + U \cdot \nabla U = -\frac{1}{\rho}\nabla p + \nu \nabla^2U$

Second equation (continuity equation): $\nabla \cdot U = 0$

The momentum equation is an expansion of $F=ma$ from Newtonian mechanics, whereas the continuity equation enforces the simplification that the fluid is incompressible. $\nabla \cdot U$ is the divergence of the vector field $u$ and can also be written as $(\frac{\partial u}{\partial x} + \frac{\partial w}{\partial y})$ (the use of $U$ vs $u$ is to highlight that $U$ is the whole vector field, and u is the scalar field representing the x-component of the velocity of $U$, whereas $w$ is the y-component.)

In this notebook, the scheme to solving the Navier-Stokes equation is broken up into two steps. First, the momentum equation is rearranged and the pressure term is removed (for now):  
  
$\frac{\partial U}{\partial t} = -U \cdot \nabla U + \nu \nabla^2U$  
  
This equation is solved using finite-difference techniques and what is calculated are the *tentative velocities* $U^{*}(u^{*},w^{*})$. This step advects the fluid forward in time based on their current velocities to where they would be if there was no pressure gradient or incompressibility condition.

The second step involves solving a Pressure Poisson equation to calculate the correction to the tentative velocities, and then applying them.  
  
$\Delta p = -\rho \nabla \cdot (U \cdot \nabla U)$